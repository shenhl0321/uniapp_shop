<view><custom-navi vue-id="5bc50eb4-1" naviData="{{naviData}}" bind:__l="__l" vue-slots="{{['default']}}">我的订单</custom-navi><view class="container"><view class="order-tit"><text class="{{[sts==0?'on':'']}}" data-sts="0" data-event-opts="{{[['tap',[['onStsTap',['$event']]]]]}}" bindtap="__e">全部</text><text class="{{[sts==1?'on':'']}}" data-sts="1" data-event-opts="{{[['tap',[['onStsTap',['$event']]]]]}}" bindtap="__e">待支付</text><text class="{{[sts==2?'on':'']}}" data-sts="2" data-event-opts="{{[['tap',[['onStsTap',['$event']]]]]}}" bindtap="__e">待发货</text><text class="{{[sts==3?'on':'']}}" data-sts="3" data-event-opts="{{[['tap',[['onStsTap',['$event']]]]]}}" bindtap="__e">待收货</text><text class="{{[sts==5?'on':'']}}" data-sts="5" data-event-opts="{{[['tap',[['onStsTap',['$event']]]]]}}" bindtap="__e">已完成</text></view><view class="main"><block wx:if="{{$root.g0==0}}"><view class="empty">还没有任何相关订单</view></block><block wx:for="{{list}}" wx:for-item="item" wx:for-index="index" wx:key="index"><block><block wx:if="{{item.orderState==0||item.orderState==1&&sts==0}}"><view class="prod-item"><view class="order-num"><view><text>{{item.shopName?item.shopName:'小象智慧门店专卖'}}</text><image class="more" mode="widthFix" src="/static/images/icon/more01.png"></image></view><view class="order-state"><block wx:if="{{item.orderState==1}}"><view class="gray">{{''+(item.ptglid?'拼团失败，已取消':item.refundState==1?'退款中':item.refundState==2?'退款成功':item.refundState==3?'退款失败':'订单关闭')+''}}</view></block><block wx:else><block wx:if="{{item.orderState==0&&item.status==1&&item.ptglid}}"><view class="{{['order-sts  '+(item.status==1?'orange':'')+'  '+(item.status==5||item.status==6?'gray':'')]}}">拼团中，待支付</view></block><block wx:else><block wx:if="{{item.orderState==0&&item.status==2&&item.ptglid}}"><view class="{{['order-sts  '+(item.status==1?'orange':'')+'  '+(item.status==5||item.status==6?'gray':'')]}}">{{''+(item.ptstatus==0?'拼团中，已支付':item.ptstatus==1?'拼团成功，待发货':'')+''}}</view></block><block wx:else><block wx:if="{{item.orderState==0&&item.status==3&&item.ptglid}}"><view class="{{['order-sts  '+(item.status==1?'orange':'')+'  '+(item.status==5||item.status==6?'gray':'')]}}">拼团成功，已发货</view></block><block wx:else><block wx:if="{{item.orderState==0&&item.distributionType==1}}"><view class="{{['order-sts  '+(item.status==1?'orange':'')+'  '+(item.status==5||item.status==6?'gray':'')]}}">{{''+(item.refundState==3?'退款失败':item.status==1?'待支付':item.status==2?'备货中':item.status==3?'待提货':item.status==5?'已提货':'已完成')+''}}</view></block><block wx:else><block wx:if="{{item.orderState==0&&item.distributionType==2}}"><view class="{{['order-sts  '+(item.status==1?'orange':'')+'  '+(item.status==5||item.status==6?'gray':'')]}}">{{''+(item.refundState==3?'退款失败':item.status==1?'待支付':item.status==2?'待美团取件':item.status==3?'美团配送中':item.status==5?'已提货':'已完成')+''}}</view></block><block wx:else><block wx:if="{{item.orderState==0&&item.distributionType==3}}"><view class="{{['order-sts  '+(item.status==1?'orange':'')+'  '+(item.status==5||item.status==6?'gray':'')]}}">{{''+(item.refundState==3?'退款失败':item.status==1?'待支付':item.status==2?'待商家配送':item.status==3?'商家配送中':item.status==5?'已提货':'已完成')+''}}</view></block><block wx:else><block wx:if="{{item.orderState==0&&item.distributionType==4}}"><view class="{{['order-sts  '+(item.status==1?'orange':'')+'  '+(item.status==5||item.status==6?'gray':'')]}}">{{''+(item.refundState==3?'退款失败':item.status==1?'待支付':item.status==2?'待发货':item.status==3?'待收货':item.status==5?'已收货':'已完成')+''}}</view></block></block></block></block></block></block></block></block></view></view><block><block wx:for="{{item.orderItemDtos}}" wx:for-item="prod" wx:for-index="index2" wx:key="prodId"><block><view><view data-event-opts="{{[['tap',[['toOrderDetailPage',['$0'],[[['list','',index]]]]]]]}}" class="item-cont" bindtap="__e"><view class="prod-pic"><image src="{{prod.pic}}"></image></view><view class="prod-info"><view class="prodname-price"><view class="prodname">{{prod.prodName}}</view><view class="prodprice"><text class="small">￥</text><text class="bignum">{{prod.price}}</text></view></view><view class="prod-info-cont"><view class="skuname">{{prod.skuName?prod.skuName:'默认规格'}}</view><view class="actualTotal"><text class="small">x</text><text class="bignum">{{prod.prodCount}}</text></view></view></view></view></view></block></block></block><view class="total-num"><view class="prodprice">实付：<text class="big-num">{{"￥"+item.actualTotal}}</text><text class="small-num"></text><text class="transferfree">(免配送费)</text></view></view><view class="prod-foot"><view class="btn"><block wx:if="{{item.orderState==0}}"><block><block wx:if="{{item.status==5&&item.refundState==0}}"><text class="button" data-ordernum="{{item.orderNumber}}" data-event-opts="{{[['tap',[['refundApplication',['$0'],[[['list','',index,'orderNumber']]]]]]]}}" bindtap="__e">申请退款</text></block><block wx:if="{{item.status==2&&item.refundState==0&&!item.ptglid||item.status==2&&item.ptglid&&item.ptstatus!=1}}"><text data-event-opts="{{[['tap',[['openRefundPop',['$0',2],[[['list','',index,'orderNumber']]]]]]]}}" class="button" bindtap="__e">申请退款</text></block><block wx:if="{{item.status==1}}"><text data-event-opts="{{[['tap',[['openRefundPop',['$0',1],[[['list','',index,'orderNumber']]]]]]]}}" class="button" bindtap="__e">取消订单</text></block><block wx:if="{{item.status==1}}"><text data-event-opts="{{[['tap',[['onPayAgain',['$0'],[[['list','',index,'orderNumber']]]]]]]}}" class="button yellowBack" bindtap="__e">去支付</text></block><block wx:if="{{item.status==2&&item.ptstatus=='0'}}"><text data-event-opts="{{[['tap',[['inviteToGroupbuy',['$0'],[[['list','',index]]]]]]]}}" class="button yellowBack widther" bindtap="__e">邀请好友拼团</text></block><block wx:if="{{item.status==2&&item.ptstatus==1||item.status==2&&!item.ptglid}}"><text data-event-opts="{{[['tap',[['alertTransfer',['$0'],[[['list','',index]]]]]]]}}" class="button yellowBack widther" bindtap="__e">提醒发货</text></block><block wx:if="{{item.status==3&&item.distributionType==1}}"><text data-event-opts="{{[['tap',[['toSelfMentionAddress',['$0'],[[['list','',index]]]]]]]}}" class="button" bindtap="__e">查看地址</text></block><block wx:if="{{item.status==3&&item.distributionType==2}}"><text data-event-opts="{{[['tap',[['toMeituanTransfer',['$0'],[[['list','',index,'orderNumber']]]]]]]}}" class="button" bindtap="__e">查看物流</text></block><block wx:if="{{item.status==3&&item.distributionType==3}}"><text class="button" data-shopid="{{item.shopId}}" data-ordernum="{{item.orderNumber}}" data-event-opts="{{[['tap',[['toShopTransfer',['$0'],[[['list','',index]]]]]]]}}" bindtap="__e">查看物流</text></block><block wx:if="{{item.status==3&&item.distributionType==4}}"><text data-event-opts="{{[['tap',[['toDeliveryPage',['$0'],[[['list','',index,'orderNumber']]]]]]]}}" class="button" bindtap="__e">查看物流</text></block><block wx:if="{{item.refundState==3}}"><text data-event-opts="{{[['tap',[['',['$event']]]]]}}" class="button" bindtap="__e">联系商家</text></block><block wx:if="{{item.status==3}}"><text data-event-opts="{{[['tap',[['onConfirmReceive',['$0'],[[['list','',index,'orderNumber']]]]]]]}}" class="button warn" bindtap="__e">确认收货</text></block><block wx:if="{{item.status==5||item.status==6}}"><text class="button warn">去评价</text></block><block wx:if="{{item.status==5||item.status==6}}"><text data-event-opts="{{[['tap',[['oneMoreTime',['$0'],[[['list','',index,'orderNumber']]]]]]]}}" class="button warn2" bindtap="__e">再来一单</text></block></block></block><block wx:if="{{item.orderState==1&&item.refundState==0}}"><text data-event-opts="{{[['tap',[['delOrderList',['$0'],[[['list','',index,'orderNumber']]]]]]]}}" class="button" bindtap="__e">删除订单</text></block><block wx:if="{{item.orderState==1&&item.ptglid}}"><text data-event-opts="{{[['tap',[['groupBuyAgain',['$0'],[[['list','',index]]]]]]]}}" class="button warn" bindtap="__e">再次开团</text></block></view></view></view></block></block></block></view></view><block wx:if="{{showRefundPop}}"><view class="refundPop" catchtouchmove="none"><view data-event-opts="{{[['tap',[['closeRefundPop',['$event']]]]]}}" class="hide" bindtap="__e"></view><view class="refundBox" animation="{{refundAnimation}}"><view class="refund-tit">{{openType==1?'请选择取消订单的原因':'请选择退款的原因'}}</view><view class="picker"><radio-group data-event-opts="{{[['change',[['radioChange',['$event']]]]]}}" bindchange="__e"><block wx:for="{{openType==1?cancelResons:refundReasons}}" wx:for-item="item" wx:for-index="index" wx:key="index"><label class="weui-cell weui-check__label"><view class="weui-cell__hd"><radio value="{{item.value}}"></radio></view><view class="weui-cell__bd">{{item.tit}}</view></label></block></radio-group></view><view data-event-opts="{{[['tap',[['onCancelOrder',['$event']]]]]}}" class="refundSubmit-btn" bindtap="__e">提交</view></view></view></block><view class="imagePathBox" hidden="{{maskHidden==false}}"><view class="mask" hidden="{{maskHidden==false}}" data-event-opts="{{[['tap',[['closeImage',['$event']]]]]}}" bindtap="__e"></view><image class="shengcheng" style="{{('height:'+screenWidth*0.9*1.8+'px')}}" src="{{imagePath}}"></image><button class="baocun" open-type="share" data-event-opts="{{[['tap',[['baocun',['$event']]]]]}}" bindtap="__e">点击保存至相册,分享到朋友圈</button></view><view class="canvas-box"><canvas style="{{('width:'+screenWidth+'px;height:'+screenWidth*1.8+'px;position:fixed;top:9999px')}}" canvas-id="mycanvas"></canvas></view></view>